<Page x:Class="MigracaoAD.UI.Views.AgentTestPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ScrollViewer>
    <StackPanel Margin="0">
      <TextBlock Text="ðŸ¤– Teste de Conectividade com Agentes" FontSize="24" FontWeight="Bold" Margin="0,0,0,8"/>
      <TextBlock Text="Teste a conexÃ£o com os agentes instalados nos servidores e execute comandos de teste."
                 Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,24"/>

      <!-- Servidor Origem -->
      <Border Style="{StaticResource Card}">
        <StackPanel>
          <TextBlock Text="ðŸ–¥ï¸ Servidor Origem" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
          
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="16"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <StackPanel Grid.Column="0">
              <Label Content="IP do servidor"/>
              <TextBox x:Name="SourceIpBox" Text="{Binding SourceDcIp, Mode=TwoWay}"/>
            </StackPanel>
            
            <StackPanel Grid.Column="2">
              <Label Content="Status"/>
              <TextBlock x:Name="SourceStatus" Text="âšª NÃ£o testado" FontSize="14" Padding="12,10" 
                         Background="{DynamicResource CardBg}" VerticalAlignment="Center"/>
            </StackPanel>
          </Grid>
          
          <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
            <Button Content="ðŸ”Œ Testar ConexÃ£o" Click="TestSourceConnection_Click" MinWidth="150"/>
            <Button Content="ðŸ“Š Obter InformaÃ§Ãµes" Click="GetSourceInfo_Click" MinWidth="150"/>
            <Button Content="ðŸ’» Executar Comando" Click="ExecuteSourceCommand_Click" MinWidth="150"/>
          </StackPanel>
          
          <Border Background="{DynamicResource AppBg}" Padding="12" Margin="0,12,0,0" CornerRadius="6">
            <TextBlock x:Name="SourceOutput" TextWrapping="Wrap" FontFamily="Consolas" FontSize="12" 
                       Text="Aguardando teste..."/>
          </Border>
        </StackPanel>
      </Border>

      <!-- Servidor Destino -->
      <Border Style="{StaticResource Card}">
        <StackPanel>
          <TextBlock Text="â˜ï¸ Servidor Destino" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
          
          <Grid>
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="16"/>
              <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <StackPanel Grid.Column="0">
              <Label Content="IP do servidor"/>
              <TextBox x:Name="TargetIpBox" Text="{Binding TargetDcIp, Mode=TwoWay}"/>
            </StackPanel>
            
            <StackPanel Grid.Column="2">
              <Label Content="Status"/>
              <TextBlock x:Name="TargetStatus" Text="âšª NÃ£o testado" FontSize="14" Padding="12,10" 
                         Background="{DynamicResource CardBg}" VerticalAlignment="Center"/>
            </StackPanel>
          </Grid>
          
          <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
            <Button Content="ðŸ”Œ Testar ConexÃ£o" Click="TestTargetConnection_Click" MinWidth="150"/>
            <Button Content="ðŸ“Š Obter InformaÃ§Ãµes" Click="GetTargetInfo_Click" MinWidth="150"/>
            <Button Content="ðŸ’» Executar Comando" Click="ExecuteTargetCommand_Click" MinWidth="150"/>
          </StackPanel>
          
          <Border Background="{DynamicResource AppBg}" Padding="12" Margin="0,12,0,0" CornerRadius="6">
            <TextBlock x:Name="TargetOutput" TextWrapping="Wrap" FontFamily="Consolas" FontSize="12" 
                       Text="Aguardando teste..."/>
          </Border>
        </StackPanel>
      </Border>

      <!-- Testes AvanÃ§ados -->
      <Border Style="{StaticResource Card}" Background="{DynamicResource SelectedBg}">
        <StackPanel>
          <TextBlock Text="ðŸ§ª Testes AvanÃ§ados" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
          
          <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
            <Button Content="ðŸ”„ Testar Ambos" Click="TestBoth_Click" MinWidth="150" 
                    ToolTip="Testa conexÃ£o com ambos os servidores simultaneamente"/>
            <Button Content="ðŸŒ Testar Conectividade Entre Servidores" Click="TestInterServer_Click" MinWidth="250" 
                    ToolTip="Testa se os servidores conseguem se comunicar"/>
            <Button Content="ðŸ“‹ Listar Compartilhamentos" Click="ListShares_Click" MinWidth="180" 
                    ToolTip="Lista compartilhamentos SMB em ambos os servidores"/>
          </StackPanel>
          
          <Border Background="{DynamicResource AppBg}" Padding="12" CornerRadius="6">
            <TextBlock x:Name="AdvancedOutput" TextWrapping="Wrap" FontFamily="Consolas" FontSize="12" 
                       Text="Aguardando teste avanÃ§ado..."/>
          </Border>
        </StackPanel>
      </Border>

      <!-- Guia RÃ¡pido -->
      <Border Background="{DynamicResource SelectedBg}" BorderBrush="{DynamicResource Accent}" BorderThickness="1"
              Padding="16" Margin="0,0,0,16" CornerRadius="8">
        <StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
            <TextBlock Text="ðŸ’¡" FontSize="18" Margin="0,0,8,0"/>
            <TextBlock Text="Guia RÃ¡pido" FontWeight="Bold" FontSize="15"/>
          </StackPanel>
          <TextBlock TextWrapping="Wrap" Margin="0,0,0,8" Foreground="{DynamicResource TextSecondary}">
            <Run Text="1. Certifique-se de que o agente estÃ¡ instalado nos servidores"/>
            <LineBreak/>
            <Run Text="2. Preencha os IPs dos servidores acima"/>
            <LineBreak/>
            <Run Text="3. Configure o token na pÃ¡gina 'Ambiente &amp; Credenciais'"/>
            <LineBreak/>
            <Run Text="4. Clique em 'Testar ConexÃ£o' para verificar se os agentes estÃ£o respondendo"/>
            <LineBreak/>
            <Run Text="5. Use 'Obter InformaÃ§Ãµes' para ver detalhes do sistema"/>
            <LineBreak/>
            <Run Text="6. Use 'Executar Comando' para testar comandos PowerShell personalizados"/>
          </TextBlock>
          <Button Content="ðŸ“– Abrir Guia de InstalaÃ§Ã£o do Agente" Click="OpenGuide_Click" 
                  HorizontalAlignment="Left" MinWidth="250"/>
        </StackPanel>
      </Border>
    </StackPanel>
  </ScrollViewer>
</Page>

